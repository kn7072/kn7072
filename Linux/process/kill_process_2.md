[источник](https://ru.linux-console.net/?p=34389)

- [ Как завершить зависшие или нежелательные пользовательские сеансы в Linux](#link_1)
  - [ Что такое TTY и PTS в Linux?](#link_2)
    - [ TTY (телетайп)](#link_3)
    - [ PTS (ведомый псевдотерминал)](#link_4)
  - [ Как завершить зависшие/нежелательные пользовательские сеансы в Linux](#link_5)
    - [ Завершить сеанс пользователя с помощью телетайпа](#link_6)
    - [ Завершить сеанс пользователя по идентификатору процесса](#link_7)
  - [ Заключение](#link_8)

# Как завершить зависшие или нежелательные пользовательские сеансы в Linux <a name="link_1"></a>

---

Нужна помощь с зависанием пользовательских сеансов в Linux? Вот как их прекратить и обеспечить бесперебойную и безопасную работу вашей системы.
Для пользователей Linux зависание или нежелательные пользовательские сеансы могут оказаться неприятными. В то же время эти сеансы могут подвергнуть вашу систему потенциальным рискам, делая ее уязвимой для несанкционированного доступа или утечки данных.

Таким образом, независимо от того, вызваны ли эти затянувшиеся сеансы некорректным поведением приложений, системными сбоями или ошибками пользователя, они могут снизить производительность и поставить под угрозу безопасность и производительность системы.

Но не бойтесь; Цель этой статьи — предоставить вам знания и инструменты для восстановления контроля и поддержания бесперебойной работы системы Linux. Изучив правильные методы решения таких ситуаций, вы сможете обеспечить более безопасную вычислительную среду и защитить свои ценные данные.

Однако прежде чем двигаться дальше, нам необходимо прояснить значение двух терминов, TTY и PTS, которые напрямую связаны с завершением сеанса пользователя в Linux.

## Что такое TTY и PTS в Linux? <a name="link_2"></a>

В Linux и «PTS», и «TTY» относятся к различным терминальным устройствам, используемым для связи между пользователем и операционной системой. Они служат интерфейсами для ввода команд и получения выходных данных от системы.

```
ps -C bash
```

### TTY (телетайп) <a name="link_3"></a>

«TTY» изначально означало телетайп, устройство, похожее на пишущую машинку, которое использовалось для ввода и вывода на заре компьютерной эры.

В современных системах Linux TTY представляет собой физическую или виртуальную консоль, с помощью которой пользователи могут напрямую взаимодействовать с системой.

### PTS (ведомый псевдотерминал) <a name="link_4"></a>

PTS означает «псевдотерминальный ведомый». Это виртуальный терминал, который имитирует аппаратный терминал, но не подключен напрямую к какому-либо физическому устройству.

Вместо этого система создает его и управляет им для поддержки мультиплексирования терминалов, удаленного входа в систему и различных интерактивных приложений.

Например, вы обычно используете псевдотерминал, когда используете приложения-эмуляторы терминала, такие как Терминал GNOME или Konsole KDE, чтобы получить доступ к оболочке вашей системы Linux.

Эти эмуляторы действуют как «главная» сторона псевдотерминала, в то время как оболочка или процесс, работающий внутри терминала, действуют как «подчиненная» сторона.

Когда вы открываете несколько окон или вкладок терминала, каждое соответствует отдельному PTS. Например, если вы откроете три окна терминала, они могут быть идентифицированы как _/dev/pts/0_, _/dev/pts/1_ и _/dev/. баллы/2_.

Таким образом, и TTY, и PTS являются терминальными устройствами в Linux, которые позволяют пользователям взаимодействовать с операционной системой. TTY представляет собой физические или виртуальные консоли, а PTS используется для эмуляторов терминала и предоставляет дополнительные функции для мультиплексирования и удаленного входа в систему.

Сделав таким образом разъяснения, мы можем теперь перейти к основной теме.

## Как завершить зависшие/нежелательные пользовательские сеансы в Linux <a name="link_5"></a>

Это можно сделать двумя способами, поэтому мы рассмотрим каждый из них ниже.

### Завершить сеанс пользователя с помощью телетайпа <a name="link_6"></a>

Мы будем использовать команду `w` для получения информации о вошедших в систему пользователях в нашей системе Linux. Он отображает информацию о вошедших в систему пользователях и их действиях.

Когда вы запускаете команду `w`, она предоставляет сводку следующих сведений для каждого пользователя:

- **USER**: имя пользователя, вошедшего в систему.
- **TTY**: имя терминала или устройства, связанного с сеансом пользователя (например, /dev/tty1, pts/0).
- **FROM**: удаленный хост или IP-адрес, с которого пользователь вошел в систему. Если пользователь вошел в систему локально, будет отображаться имя TTY или символ «_–_».
- **LOGIN@**: дата и время входа пользователя в систему.
- **IDLE**: продолжительность бездействия сеанса пользователя. Если пользователь активно использует терминал, вместо этого будет отображаться «старый».
- **JCPU**: общее время ЦП, используемое всеми процессами, связанными с сеансом пользователя.
- **PCPU**: время процессора, используемое текущим процессом пользователя.
- **ЧТО**: команда, выполняемая пользователем, или процесс, связанный с терминалом.

Вот пример вывода команды `w`:

![](kill_process_2_images/c17528bf652e8286fb5e1e064e6ce0dc_MD5.avif)

Как вы можете видеть из приведенного выше примера, есть три зарегистрированных пользователя — два локально и один удаленно.

Чтобы завершить пользовательский сеанс удаленно вошедшего в систему пользователя «_linuxiac_», мы будем использовать команду `pkill` в Linux с опцией «_-KILL_». >», что означает, что процесс Linux должен быть завершен немедленно (не корректно). Используйте флаг «_-t_», чтобы указать имя телетайпа.

```undefined
pkill -KILL -t pts/1
```

![](kill_process_2_images/273ccb153cd8ba0f29078762bb07bd07_MD5.avif)

Вот и все. Как видно из повторной проверки командой `w`, сеанс пользователя с нашей системой немедленно завершается.

### Завершить сеанс пользователя по идентификатору процесса <a name="link_7"></a>

Второй подход, который мы вам покажем, использует завершение сеанса пользователя по идентификатору процесса. Для этого мы снова выполняем команду `w`, чтобы получить список вошедших в систему пользователей вместе с связанными с ними TTY/PTS.

Затем, как только мы определили сеанс TTY/PTS, используйте команду `ps` с параметрами «_-ft_», чтобы найти его PID:

```powershell
ps -ft [TTY/PTS]
```

Наконец, используйте команду `kill` с переключателем «_-9_» (безоговорочное завершение процесса), передающим идентификатор процесса. Например:

```powershell
kill -9 4374
```

![](kill_process_2_images/84576ebf468de2d3dd76f80e8d9eead3_MD5.avif)

В результате сессия пользователя мгновенно завершается.

## Заключение <a name="link_8"></a>

Знание того, как завершить зависшие или нежелательные пользовательские сеансы, имеет важное значение в области системного администрирования Linux. В этой статье мы рассмотрели два эффективных метода выполнения этой задачи: TTY/PTS или идентификатор процесса.

Подход TTY/PTS обеспечивает простые средства завершения пользовательских сеансов. С другой стороны, завершение сеансов по идентификатору процесса предлагает более точный и прямой метод; какой из двух подходов использовать? Решение полностью зависит от вас.

Помните, что крайне важно проявлять осторожность независимо от того, выбираете ли вы подход TTY/PTS или метод идентификации процесса. Убедитесь, что вы завершили правильный сеанс пользователя или процесс, чтобы предотвратить случайную потерю данных или непредвиденные последствия.

Нужна более подробная информация? Проверьте справочные страницы команд `pkill` и `kill` .
