https://man7.org/linux/man-pages/man8/ip-netns.8.html
https://habr.com/ru/post/549414/

**network namespace** –∏–∑–æ–ª–∏—Ä—É–µ—Ç —Ä–µ—Å—É—Ä—Å—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —Å–µ—Ç—å—é: –ø—Ä–æ—Ü–µ—Å—Å, —Ä–∞–±–æ—Ç–∞—é—â–∏–π –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º network namespace, –∏–º–µ–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–µ—Ç–µ–≤—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, —Ç–∞–±–ª–∏—Ü—ã –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏, –ø—Ä–∞–≤–∏–ª–∞ —Ñ–∞–µ—Ä–≤–æ–ª–∞ –∏ —Ç.–¥. –ú—ã –º–æ–∂–µ–º –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ —É–≤–∏–¥–µ—Ç—å —ç—Ç–æ –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ, —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–≤ –Ω–∞—à–µ —Ç–µ–∫—É—â–µ–µ —Å–µ—Ç–µ–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ.

**–ö–æ–º–∞–Ω–¥–∞ ip**

–ü–æ—Å–∫–æ–ª—å–∫—É –≤ —ç—Ç–æ–º –ø–æ—Å—Ç–µ –º—ã –±—É–¥–µ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å —Å–µ—Ç–µ–≤—ã–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏, –º—ã –≤–µ—Ä–Ω–µ–º –∂–µ—Å—Ç–∫–æ–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ –Ω–∞–ª–∏—á–∏—è –ø—Ä–∞–≤ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä–æ–µ –º—ã —Å–º—è–≥—á–∏–ª–∏ –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –ø–æ—Å—Ç–∞—Ö. –° —ç—Ç–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞ –º—ã –±—É–¥–µ–º –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞—Ç—å, —á—Ç–æ –∫–∞–∫ ip, —Ç–∞–∫ –∏ isolate –±—É–¥—É—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è —Å sudo.

**$ ip link list**
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000
link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
2: ens33: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000
link/ether 00:0c:29:96:2e:3b brd ff:ff:ff:ff:ff:ff

(–∑–¥–µ—Å—å –µ—Å—Ç—å lo ‚Äî loopback-–∏–Ω—Ç–µ—Ä—Ñ–µ—Å –∏ `ens33, ethernet-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å LAN.)

–ö–∞–∫ –∏ —Å–æ –≤—Å–µ–º–∏ –¥—Ä—É–≥–∏–º–∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞–º–∏ –∏–º—ë–Ω, —Å–∏—Å—Ç–µ–º–∞ —Å—Ç–∞—Ä—Ç—É–µ—Ç —Å –Ω–∞—á–∞–ª—å–Ω—ã–º network namespace, –∫–æ—Ç–æ—Ä–æ–º—É –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ—Ü–µ—Å—Å—ã, –µ—Å–ª–∏ –Ω–µ –∑–∞–¥–∞–Ω–æ –∏–Ω–æ–µ. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã **ip link list** –∫–∞–∫ –µ—Å—Ç—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–º —Å–µ—Ç–µ–≤—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏–µ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ–º—É –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤—É –∏–º—ë–Ω (–ø–æ—Å–∫–æ–ª—å–∫—É –∏ –Ω–∞—à —à–µ–ª–ª, –∏ –∫–æ–º–∞–Ω–¥–∞ ip –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç —ç—Ç–æ–º—É –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤—É –∏–º—ë–Ω).

## –ò–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º—ë–Ω Network

–î–∞–≤–∞–π—Ç–µ —Å–æ–∑–¥–∞–¥–∏–º –Ω–æ–≤—ã–π network namespace:

**$ ip netns add coke**
**$ ip netns list**
coke

–ò —Å–Ω–æ–≤–∞ –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –∫–æ–º–∞–Ω–¥—É ip. –ü–æ–¥–∫–æ–º–∞–Ω–¥–∞ netns –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º –∏–≥—Ä–∞—Ç—å—Å—è —Å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞–º–∏ –∏–º—ë–Ω network: –Ω–∞–ø—Ä–∏–º–µ—Ä, –º—ã –º–æ–∂–µ–º —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Å–µ—Ç–µ–≤—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ network —Å –ø–æ–º–æ—â—å—é –ø–æ–¥–∫–æ–º–∞–Ω–¥—ã add –∫–æ–º–∞–Ω–¥—ã netns –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å list –¥–ª—è –∏—Ö –≤—ã–≤–æ–¥–∞.
–í—ã –º–æ–≥–ª–∏ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ list –≤–æ–∑–≤—Ä–∞—â–∞–ª —Ç–æ–ª—å–∫–æ –Ω–∞—à –≤–Ω–æ–≤—å —Å–æ–∑–¥–∞–Ω–Ω—ã–π namespace. –†–∞–∑–≤–µ –æ–Ω –Ω–µ –¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –ø–æ –∫—Ä–∞–π–Ω–µ–π –º–µ—Ä–µ –¥–≤–∞, –æ–¥–Ω–∏–º –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –±—ã–ª –±—ã –∏—Å—Ö–æ–¥–Ω—ã–º namespace, –æ –∫–æ—Ç–æ—Ä–æ–º –º—ã —É–ø–æ–º–∏–Ω–∞–ª–∏ —Ä–∞–Ω–µ–µ? –ü—Ä–∏—á–∏–Ω–∞ —ç—Ç–æ–≥–æ –≤ —Ç–æ–º, —á—Ç–æ ip —Å–æ–∑–¥–∞—ë—Ç —Ç–æ, —á—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è named network namespace, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–æ network namespace, –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ–º—ã–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∏–º–µ–Ω–µ–º (–≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ coke). –¢–æ–ª—å–∫–æ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º—ë–Ω network –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø–æ–¥–∫–æ–º–∞–Ω–¥–æ–π list, –∞ –∏–∑–Ω–∞—á–∞–ª—å–Ω—ã–π network namespace –Ω–µ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–π.

–ü—Ä–æ—â–µ –≤—Å–µ–≥–æ –ø–æ–ª—É—á–∏—Ç—å –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º—ë–Ω network. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ –∫–∞–∂–¥–æ–º –∏–º–µ–Ω–æ–≤–∞–Ω–Ω–æ–º network namespace —Å–æ–∑–¥–∞—ë—Ç—Å—è —Ñ–∞–π–ª –≤ –∫–∞—Ç–∞–ª–æ–≥–µ /var/run/netns –∏ –∏–º —Å–º–æ–∂–µ—Ç –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø—Ä–æ—Ü–µ—Å—Å, –∫–æ—Ç–æ—Ä—ã–π —Ö–æ—á–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ —Å–≤–æ–π namespace. –î—Ä—É–≥–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤ –∏–º—ë–Ω network –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –æ–Ω–∏ –º–æ–≥—É—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –±–µ–∑ –Ω–∞–ª–∏—á–∏—è –∫–∞–∫–æ–≥–æ-–ª–∏–±–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ ‚Äî –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –Ω–µ–∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã –∫–∞–∫ —Ç–æ–ª—å–∫–æ –∑–∞–≤–µ—Ä—à–∞—Ç—Å—è –≤—Å–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏–µ –∏–º –ø—Ä–æ—Ü–µ—Å—Å—ã.

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ —É –Ω–∞—Å –µ—Å—Ç—å –¥–æ—á–µ—Ä–Ω–∏–π network namespace, –º—ã –º–æ–∂–µ–º –≤–∑–≥–ª—è–Ω—É—Ç—å –Ω–∞ —Å–µ—Ç—å —Å –µ–≥–æ —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è.
–ú—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ C$ –¥–ª—è –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è —à–µ–ª–ª–∞, —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –≤ –¥–æ—á–µ—Ä–Ω–µ–º network namespace.

**$ ip netns exec coke bash**
**C$ ip link list**
1: lo: <LOOPBACK> mtu 65536 qdisc noop **state DOWN** mode DEFAULT group default qlen 1000
link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00

–ó–∞–ø—É—Å–∫ —Å—É–±–∫–æ–º–∞–Ω–¥—ã exec $namespace $command –≤—ã–ø–æ–ª–Ω—è–µ—Ç $command –≤ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω–æ–º network namespace $namespace. –ó–¥–µ—Å—å –º—ã –∑–∞–ø—É—Å—Ç–∏–ª–∏ —à–µ–ª–ª –≤–Ω—É—Ç—Ä–∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º—ë–Ω coke –∏ –ø–æ—Å–º–æ—Ç—Ä–µ–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å–µ—Ç–µ–≤—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞. –ú—ã –≤–∏–¥–∏–º, —á—Ç–æ, –ø–æ –∫—Ä–∞–π–Ω–µ–π –º–µ—Ä–µ, –Ω–∞—à–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ ens33 –∏—Å—á–µ–∑–ª–æ. –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ –≤–∏–¥–Ω–æ, —ç—Ç–æ –ª—É–ø–±–µ–∫ –∏ –¥–∞–∂–µ —ç—Ç–æ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å __–ø–æ–≥–∞—à–µ–Ω__(state DOWN).
__C$ ping 127.0.0.1\_\_
connect: Network is unreachable

–ú—ã –¥–æ–ª–∂–Ω—ã —Ç–µ–ø–µ—Ä—å —Å–≤—ã–∫–Ω—É—Ç—å—Å—è —Å —Ç–µ–º, —á—Ç–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤ –∏–º—ë–Ω –æ–±—ã—á–Ω–æ –æ—á–µ–Ω—å —Å—Ç—Ä–æ–≥–∏–µ. –î–ª—è –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤ –∏–º—ë–Ω network, –∫–∞–∫ –º—ã –≤–∏–¥–∏–º, –Ω–∏–∫–∞–∫–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤, –ø–æ–º–∏–º–æ loopback, –Ω–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ. –ú—ã –º–æ–∂–µ–º –ø–æ–¥–Ω—è—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å loopback –±–µ–∑ –≤—Å—è–∫–∏—Ö —Ñ–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–µ–π:

**C$ ip link set dev lo up**
**C$ ping 127.0.0.1**
PING 127.0.0.1 (127.0.0.1) 56(84) bytes of data.
64 bytes from 127.0.0.1: icmp_seq=1 ttl=64 time=0.034 ms
...

## –°–µ—Ç–µ–≤–æ–µ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

–ú—ã —É–∂–µ –Ω–∞—á–∏–Ω–∞–µ–º –ø–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ –∑–∞–ø—É—Å—Ç–∏–≤ –ø—Ä–æ—Ü–µ—Å—Å –≤–æ –≤–ª–æ–∂–µ–Ω–Ω–æ–º network namespace, —Ç–∞–∫–æ–º –∫–∞–∫ coke, –º—ã –º–æ–∂–µ–º –±—ã—Ç—å —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ –æ–Ω –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω –æ—Ç –æ—Å—Ç–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –≤ —Ç–æ–º, —á—Ç–æ –∫–∞—Å–∞–µ—Ç—Å—è —Å–µ—Ç–∏. –ù–∞—à —à–µ–ª–ª-–ø—Ä–æ—Ü–µ—Å—Å, —Ä–∞–±–æ—Ç–∞—é—â–∏–π –≤ coke, –º–æ–∂–µ—Ç –æ–±—â–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ loopback. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –æ–Ω –º–æ–∂–µ—Ç –æ–±—â–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ —Å –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ç–∞–∫–∂–µ —è–≤–ª—è—é—Ç—Å—è —á–ª–µ–Ω–∞–º–∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º—ë–Ω coke, –Ω–æ –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è –¥—Ä—É–≥–∏—Ö —Ç–∞–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –Ω–µ—Ç (–∏, –≤–æ –∏–º—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏, –º—ã —Ö–æ—Ç–µ–ª–∏ –±—ã, —á—Ç–æ–±—ã —Ç–∞–∫ –∏ –æ—Å—Ç–∞–≤–∞–ª–æ—Å—å), —Ç–∞–∫ —á—Ç–æ –æ–Ω –Ω–µ–º–Ω–æ–≥–æ –æ–¥–∏–Ω–æ–∫. –î–∞–≤–∞–π—Ç–µ –ø–æ–ø—Ä–æ–±—É–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ—Å–ª–∞–±–∏—Ç—å —ç—Ç—É –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å. –ú—ã —Å–æ–∑–¥–∞–¥–∏–º —Ç—É–Ω–Ω–µ–ª—å, —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ—Ü–µ—Å—Å—ã –≤ coke —Å–º–æ–≥—É—Ç –æ–±—â–∞—Ç—å—Å—è —Å –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ –≤ –Ω–∞—à–µ–º –∏—Å—Ö–æ–¥–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –∏–º—ë–Ω.

–°–µ–π—á–∞—Å –ª—é–±–æ–µ —Å–µ—Ç–µ–≤–æ–µ –æ–±—â–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ –∫–∞–∫–æ–µ-—Ç–æ —Å–µ—Ç–µ–≤–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, –∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –º–æ–∂–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å —Ä–æ–≤–Ω–æ –≤ –æ–¥–Ω–æ–º network namespace –≤ –¥–∞–Ω–Ω—ã–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏, –ø–æ—ç—Ç–æ–º—É —Å–≤—è–∑—å –º–µ–∂–¥—É –ª—é–±—ã–º–∏ –¥–≤—É–º—è –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ –≤ —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞—Ö –∏–º—ë–Ω –¥–æ–ª–∂–Ω–∞ –æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å—Å—è –∫–∞–∫ –º–∏–Ω–∏–º—É–º —á–µ—Ä–µ–∑ –¥–≤–∞ —Å–µ—Ç–µ–≤—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ ‚Äî –ø–æ –æ–¥–Ω–æ–º—É –≤ –∫–∞–∂–¥–æ–º network namespace.

## –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ veth

–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–æ–≥–æ –Ω–∞—à–µ–≥–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è, –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–µ—Ç–µ–≤–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ **virtual ethernet (–∏–ª–∏ —Å–æ–∫—Ä–∞—â—ë–Ω–Ω–æ veth)**. –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ veth –≤—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞—é—Ç—Å—è –∫–∞–∫ –ø–∞—Ä–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É —Ç—É–Ω–Ω–µ–ª—è, —Ç–∞–∫ —á—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏—è, –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –Ω–∞ –æ–¥–Ω–æ–º –∫–æ–Ω—Ü–µ, –≤—ã—Ö–æ–¥—è—Ç –∏–∑ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω–∞ –¥—Ä—É–≥–æ–º. –í—ã –º–æ–≥–ª–∏ –±—ã –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç—å, —á—Ç–æ –º—ã –º–æ–≥–ª–∏ –±—ã –ª–µ–≥–∫–æ –∏–º–µ—Ç—å –æ–¥–∏–Ω –∫–æ–Ω–µ—Ü –≤ –∏—Å—Ö–æ–¥–Ω–æ–º network namespace, –∞ –¥—Ä—É–≥–æ–π ‚Äî –≤ –Ω–∞—à–µ–º –¥–æ—á–µ—Ä–Ω–µ–º network namespace, –∞ –≤—Å—ë –æ–±—â–µ–Ω–∏–µ –º–µ–∂–¥—É –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞–º–∏ –∏–º—ë–Ω network –ø—Ä–æ—Ö–æ–¥–∏–ª–æ –±—ã —á–µ—Ä–µ–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –æ–∫–æ–Ω–µ—á–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ veth (–∏ –≤—ã –±—ã–ª–∏ –±—ã –ø—Ä–∞–≤—ã).

#–°–æ–∑–¥–∞–Ω–∏–µ –ø–∞—Ä—ã veth (veth0 <=> veth1)
**$ ip link add veth0 type veth peer name veth1**

#–ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ veth1 –≤ –Ω–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏–º—ë–Ω
**$ ip link set veth1 netns coke**

#–ü—Ä–æ—Å–º–æ—Ç—Ä —Å–µ—Ç–µ–≤—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤ –Ω–æ–≤–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –∏–º—ë–Ω

```bash
sudo ip netns exec coke ip a
```

**C$ ip link list**
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000
link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
7: veth1@if8: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000
link/ether ee:16:0c:23:f3:af brd ff:ff:ff:ff:ff:ff link-netnsid 0

–ù–∞—à–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ veth1 —Ç–µ–ø–µ—Ä—å –ø–æ—è–≤–∏–ª–æ—Å—å –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –∏–º—ë–Ω coke. –ù–æ —á—Ç–æ–±—ã –∑–∞—Å—Ç–∞–≤–∏—Ç—å –ø–∞—Ä—É veth —Ä–∞–±–æ—Ç–∞—Ç—å, –Ω–∞–º –Ω—É–∂–Ω–æ –Ω–∞–∑–Ω–∞—á–∏—Ç—å —Ç–∞–º IP-–∞–¥—Ä–µ—Å–∞ –∏ –ø–æ–¥–Ω—è—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã. –ú—ã —Å–¥–µ–ª–∞–µ–º —ç—Ç–æ –≤ –∫–∞–∂–¥–æ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º network namespace.

#–í –∏—Å—Ö–æ–¥–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –∏–º—ë–Ω
**$ ip addr add 10.1.1.1/24 dev veth0**
**$ ip link set dev veth0 up**

#–í –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –∏–º—ë–Ω coke
**C$ ip addr add 10.1.1.2/24 dev veth1**
**C$ ip link set dev veth1 up**

C$ ip addr show veth1
7: veth1@if8: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default qlen 1000
link/ether ee:16:0c:23:f3:af brd ff:ff:ff:ff:ff:ff link-netnsid 0
inet 10.1.1.2/24 scope global veth1
valid_lft forever preferred_lft forever
inet6 fe80::ec16:cff:fe23:f3af/64 scope link
valid_lft forever preferred_lft forever

–ú—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å, —á—Ç–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å veth1 –ø–æ–¥–Ω—è—Ç –∏ –∏–º–µ–µ—Ç –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –Ω–∞–º–∏ –∞–¥—Ä–µ—Å 10.1.1.2. –¢–æ–∂–µ —Å–∞–º–æ–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏–∑–æ–π—Ç–∏ —Å veth0 –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –∏–º—ë–Ω. –¢–µ–ø–µ—Ä—å —É –Ω–∞—Å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–¥–µ–ª–∞—Ç—å –∏–Ω—Ç–µ—Ä-namespace ping –º–µ–∂–¥—É –¥–≤—É–º—è –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏, –∑–∞–ø—É—â–µ–Ω–Ω—ã–º–∏ –≤ –æ–±–æ–∏—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞—Ö –∏–º—ë–Ω.

**$ ping -I veth0 10.1.1.2**
PING 10.1.1.2 (10.1.1.2) 56(84) bytes of data.
64 bytes from 10.1.1.2: icmp_seq=1 ttl=64 time=0.041 ms
...
**C$ ping 10.1.1.1**
PING 10.1.1.1 (10.1.1.1) 56(84) bytes of data.
64 bytes from 10.1.1.1: icmp_seq=1 ttl=64 time=0.067 ms

## –ù–µ–º–Ω–æ–≥–æ –æ Linux namespaces

https://xakep.ru/2018/01/15/vpn-linux-network-namespaces/

–í Linux —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω (namespace), –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∏–∑–æ–ª—è—Ü–∏—é —Ä–∞–∑–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ —Å–∏—Å—Ç–µ–º—ã. –û–Ω–∞ –≤–æ–≤—Å—é –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤ –ø—Ä–æ–µ–∫—Ç–∞—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä —Ç–∞–∫–∏—Ö –∫–∞–∫ Docker. –°—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∏–ø–æ–≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤ –∏–º–µ–Ω: pid, net, mnt, user, uts, ipc.

–ù–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏–º–µ–Ω –¥–ª—è —Å–µ—Ç–µ–π (netns), –∫–æ—Ç–æ—Ä–æ–µ –∏–∑–æ–ª–∏—Ä—É–µ—Ç —Å–µ—Ç–µ–≤—ã–µ —Ä–µ—Å—É—Ä—Å—ã. –î–ª—è –∫–∞–∂–¥–æ–≥–æ netns –º–æ–∂–Ω–æ –Ω–∞–∑–Ω–∞—á–∞—Ç—å: —Å–≤–æ–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã, –Ω–∞–±–æ—Ä—ã IP-–∞–¥—Ä–µ—Å–æ–≤ –∏ –ø–æ—Ä—Ç–æ–≤ (—Å–æ–∫–µ—Ç—ã), —Ç–∞–±–ª–∏—Ü—ã –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏, –ø—Ä–∞–≤–∏–ª–∞ —Ñ–∞–π—Ä–≤–æ–ª–∞ –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ. –ï—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–º–µ—â–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –∏–∑ –æ–¥–Ω–æ–≥–æ netns –≤ –¥—Ä—É–≥–æ–π. –§–∏–∑–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, eth0) –º–æ–∂–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Ç–æ–ª—å–∫–æ –≤ –æ–¥–Ω–æ–º netns.

–ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –≤—Å–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –∏ –ø—Ä–æ—Ü–µ—Å—Å—ã —Å–æ–¥–µ—Ä–∂–∞—Ç—Å—è –≤ –∏—Å—Ö–æ–¥–Ω–æ–º (initial) netns, —É –Ω–µ–≥–æ –Ω–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∏–º–µ–Ω–∏, –∏ –æ–Ω –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ. –ü–æ—Å–ª–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –∫–∞–∫–æ–≥–æ-–ª–∏–±–æ netns –≤—Å–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –≤ –Ω–µ–º, –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ initial netns. –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ —ç—Ç–æ–º netns. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–∞–∂–µ –µ—Å–ª–∏ —É–¥–∞–ª–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π netns, –Ω–æ –ø—Ä–æ—Ü–µ—Å—Å, –∑–∞–ø—É—â–µ–Ω–Ω—ã–π –≤ –Ω–µ–º, –±—É–¥–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã–º, —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–µ –ø–µ—Ä–µ–Ω–µ—Å–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ –≤ –∏—Å—Ö–æ–¥–Ω—ã–π netns –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å –Ω–µ –±—É–¥–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º —ç—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ–∑–∂–µ.

## –ë–∞–∑–∞ netns

–ó–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å netns –æ—Ç–≤–µ—á–∞–µ—Ç —É—Ç–∏–ª–∏—Ç–∞ ip –∏–∑ –ø–∞–∫–µ—Ç–∞ iproute2. –î–ª—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è netns –º–µ–∂–¥—É —Å–æ–±–æ–π –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ä—É –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ veth. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö netns –∏ –∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è. –î–ª—è —ç—Ç–æ–≥–æ –≤—ã–ø–æ–ª–Ω–∏–º

**$ sudo ip netns add ns_1**
**$ sudo ip netns add ns_2**

–ù–∞–ª–∏—á–∏–µ —ç—Ç–∏—Ö netns —Å–º–æ—Ç—Ä–∏ –∫–æ–º–∞–Ω–¥–æ–π **ip netns list** –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ **ip netns**, —Ç–∞–∫ –∫–∞–∫ list ‚Äî –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. –î–æ–±–∞–≤–∏–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –ø–∞—Ä—É –ø—Ä–∏ –ø–æ–º–æ—â–∏ –∫–æ–º–∞–Ω–¥—ã

**$ sudo ip link add dev virt01 type veth peer name virt02**
**ip netns list**

–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–æ–±–∞–≤–∏–ª–∏—Å—å, —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–µ–º–µ—Å—Ç–∏–º virt01 –≤ netns ns_1, –∞ virt02 ‚Äî –≤ ns_2.

**$ sudo ip link set virt01 netns ns_1**
**$ sudo ip link set virt02 netns ns_2**

–ï—Å–ª–∏ –Ω–µ –ø–æ—è–≤–∏–ª–æ—Å—å —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö, –∑–Ω–∞—á–∏—Ç, –≤—Å–µ –ø—Ä–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ. –î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã –≤–Ω—É—Ç—Ä–∏ netns –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–∞
**$ sudo ip netns exec <–∏–º—è netns> <–∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è>**

–ù–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –≤–Ω—É—Ç—Ä–∏ netns ns_1 –º–æ–∂–Ω–æ –ø—Ä–∏ –ø–æ–º–æ—â–∏
**$ sudo ip netns exec ns_1 ip link**

–ü–æ—á–∏—Ç–∞–≤ man, —É–∑–Ω–∞–µ–º, —á—Ç–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–∞–Ω–¥—ã ip –≤–Ω—É—Ç—Ä–∏ netns –º–æ–∂–Ω–æ –ø—Ä–∏ –ø–æ–º–æ—â–∏
**$ sudo ip -n <–∏–º—è netns>**, –∞ –∑–Ω–∞—á–∏—Ç, **$ sudo ip netns exec ns_1 ip link** –∑–∞–º–µ–Ω—è–µ–º –Ω–∞ **$ sudo ip -n ns_1 link**

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∏–ª–∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω–Ω—ã–µ –≤ netns, –ø—Ä–µ–±—ã–≤–∞—é—Ç –≤ –æ—Ç–∫–ª—é—á–µ–Ω–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏, –¥–∞–∂–µ lo.
–î–æ–±–∞–≤–∏–º –Ω–∞—à–∏–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞–º virt01 –∏ virt02 –ø–æ IP-–∞–¥—Ä–µ—Å—É –∏ –ø–µ—Ä–µ–≤–µ–¥–µ–º –∏—Ö –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ UP. –î–ª—è —ç—Ç–æ–≥–æ –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è ¬´–ø—Ä–æ–∫–∞—á–∞–Ω–Ω–æ–π¬ª –∫–æ–º–∞–Ω–¥–æ–π, –ø–æ–¥—Å–º–æ—Ç—Ä–µ–Ω–Ω–æ–π –≤ man:

**$ sudo ip -n ns_1 addr add 10.0.0.1/24 dev virt01**
**$ sudo ip -n ns_2 addr add 10.0.0.2/24 dev virt02**
**$ sudo ip -n ns_1 link set dev virt01 up**
**$ sudo ip -n ns_2 link set dev virt02 up**
**$ sudo ip -n ns_1 addr show**
**$ sudo ip -n ns_2 addr show**

–ö–∞–∫ —è —É–∂–µ –≥–æ–≤–æ—Ä–∏–ª, —É –∫–∞–∂–¥–æ–π netns —Å–≤–æ—è —Ç–∞–±–ª–∏—Ü–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏, –ø—Ä–æ–≤–µ—Ä–∏–º —ç—Ç–æ.
–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–≤—è–∑–∏ –º–µ–∂–¥—É ns_1 –∏ ns_2 –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è –∫–æ–º–∞–Ω–¥–æ–π ping.
**$ sudo ip netns exec ns_1 ping -c 4 10.0.0.2**

–ö–∞–∫ —Ç—ã –ø–æ–º–Ω–∏—à—å, –∞–¥—Ä–µ—Å 10.0.0.2 –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É virt02, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ ns_2. –ü–æ—Ö–æ–∂–∏–º —Å–ø–æ—Å–æ–±–æ–º netns —Å–æ–µ–¥–∏–Ω—è—é—Ç —Å —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º eth0.

## –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –∏ –∑–∞–ø—É—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –≤–Ω—É—Ç—Ä–∏ netns

–ö–∞–∫ —Ç—ã –ø–æ–º–Ω–∏—à—å, –∫–æ–º–∞–Ω–¥—ã –≤–Ω—É—Ç—Ä–∏ netns –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø—Ä–∏ –ø–æ–º–æ—â–∏
**$ sudo ip netns exec <–∏–º—è netns> <–∫–æ–º–∞–Ω–¥–∞>**

–ß—Ç–æ–±—ã –Ω–µ –ø–∏—Å–∞—Ç—å –≤—Å–µ —ç—Ç–æ –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∑–∞–ø—É—Å—Ç–∏–º bash!
**$ sudo ip netns exec ns_1 bash**

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã –±—É–¥—É—Ç –∏—Å–ø–æ–ª–Ω—è—Ç—å—Å—è –≤–Ω—É—Ç—Ä–∏ netns ‚Äî –∑–∞–æ–¥–Ω–æ –∏ –ø—Ä–æ–≤–µ—Ä–∏–º —Å–∏—Ç—É–∞—Ü–∏—é —Å —Ñ–∞–π—Ä–≤–æ–ª–æ–º. **–ß—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è, –ø–∏—à–∏ exit –∏–ª–∏ CTRL + D.**
**iptables -nvL** –°–ø–∏—Å–æ–∫ –ø—Ä–∞–≤–∏–ª –ø—É—Å—Ç
–£ –º–µ–Ω—è –≤—Å–µ–≥–¥–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –ø—Ä–∞–≤–∏–ª–∞ –≤ —Ñ–∞–π—Ä–≤–æ–ª–µ, —Ç–∞–∫ —á—Ç–æ —ç—Ç–æ —Ç–æ—á–Ω–æ –æ—Ç–¥–µ–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä. üòâ
**exit**

**ip link** –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è enp0s3
–ü–µ—Ä–µ–π–¥–µ–º –∫ –ø—Ä–∏–º–µ—Ä—É —Å –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –≤ initial netns. –î–ª—è —ç—Ç–æ–≥–æ –ø—Ä–æ–≤–µ—Ä–∏–º —Ç–µ–∫—É—â–µ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ enp0s3 –∏ –ø–µ—Ä–µ–Ω–µ—Å–µ–º –µ–≥–æ –≤ ns_2.
**$ sudo ip link set dev enp0s3 netns ns_2**
**ip link** –ù–ï –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è enp0s3

–ü–æ–¥–Ω–∏–º–µ–º –µ–≥–æ –≤ netns ns_2 –∏ –∑–∞–ø—É—Å—Ç–∏–º WireShark –æ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (eakj) —Ç–∞–º –∂–µ.
**$ sudo ip -n ns_2 link set dev enp0s3 up**
**$ sudo ip -n ns_2 link**
**$ sudo ip netns exec ns_2 sudo -u eakj wireshark 2>/dev/null &**

–¢–µ–ø–µ—Ä—å —É–¥–∞–ª–∏–º netns ns_2 –∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º, –≤–µ—Ä–Ω–µ—Ç—Å—è –ª–∏ enp0s3 –≤ initial netns:
**$ sudo ip netns del ns_2**
**ip link** –ù–ï –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è enp0s3(enp0s3 –Ω–µ –æ—Å–≤–æ–±–æ–¥–∏—Ç—Å—è, –ø–æ–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å WireShark –Ω–µ –±—É–¥–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω, –¥–∞–∂–µ –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ ns_2)
–ó–∞–∫—Ä–æ–µ–º WireShark –∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º, –¥–∞—Å—Ç –ª–∏ —ç—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
**ip link** –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è enp0s3
